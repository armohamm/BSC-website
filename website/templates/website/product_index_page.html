{% extends "website/base.html" %}
{% load wagtailcore_tags wagtailimages_tags website_tags embed_filters static %}

{% block hero_cover %}
	{% image self.header_image width-2000 as heroimagedata %}
    <div class="content-header" style="background-image: url('{{ heroimagedata.url }}');">
    	<div class="container">
	    	<div>
		        <h2{% if self.intro %} class="has-intro-text"{% endif %}>{{ self.title }}</h2><br />
		        {% if self.intro %}
		        <p>{{ self.intro|safe }}</p>
		        {% endif %}
	        </div>
        </div>
    </div>
{% endblock %}

{% block content %}
    {# Listing created with a tag - allows filtering by whether the page is live #}
    {# See also the blog index or events index where the listing is created from a method defined in models.py #}
    <div class="row">
    {% for main_product in products %}
        <div class="col-sm-12">
            <div class="media products products-index-page">
                {% if main_product.key_image %}
                <a class="product-key-image pull-left" href="{% pageurl main_product %}">
                    {% image main_product.key_image fill-200x200 class="media-object img-responsive" %}
                </a>
                {% endif %}
            
                <div class="media-body">
                    <a href="{% pageurl main_product %}"><h4>{{ main_product.title }}</h4></a>
                    <p>{{ main_product.intro }}</p>

				    {% for sub_product in main_product.sub_products %}
				    	{{ sub_product.title }}
			        {% endfor %}
                </div>
            </div>
        </div>

        </div><div class="row">

	{% empty %}
	    No products found
    {% endfor %}
    </div>
{% endblock %}